# Задача RMQ/RSQ. Префиксные суммы, разреженные таблицы.

- Range Minimum/Maximum Query;
- Range Sum Query;
  <br>= Запросы на подотрезках;

## Префиксные суммы
- Отвечает на большое количество запросов о сумме на подотрезке от L до R;
- Хотим отвечать на каждый запрос за _O_(1);

<ins>Реализуем решение задачи о RSQ:</ins>
- Имеем исходный массив A с n элементами;
- Построим вспомогательный массив префиксных сумм P размера n+1, где в первой ячейке (по индексу 0) будет стоять 0;
- Заполним массив P по формуле: P[i] = A[i-1] + P[i-1];
- Тогда при поступлении запроса формата L, R, где это — границы массива с включёнными крайними элементами, мы сможем возвращать S = P[R] - P[L-1] (делаем L-1, чтобы вычитать не включая левый элемент);
- При реализации на C++, получение ответа будет занимать _O_(1), так как это сложность обращения к элементу массива, а здесь мы делаем два раза обращение и один раз берём разность двух чисел;

**Пример:**
| index | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | 
| A | 7 | -2 | 3 | 1 | 4 | 0 | -3 | 5 | 4 | 8 |  |
| P | 0 | 7 | 5 | 8 | 9 | 13 | 13 | 10 | 15 | 19 | 27 |

<br>

<ins>Реализуем решение задачи о максимальной сумме на подотрезке в массиве целых чисел:</ins>
- Хотим найти такие L, R, чтобы на данном подотрезке была максимальная сумма с учётом отрицательных элементов;
- Имеем исходный массив A с n элементами;
- Опять построим вспомогательный массив префиксных сумм P размера n+1, где в первой ячейке (по индексу 0) будет стоять 0;
- Заполним массив P по формуле: P[i] = A[i-1] + P[i-1];
- Дальше для каждого данного R нам выгоднее всего брать минимальный L на отрезке от 0, R-1, так как для подсчёта суммы мы будем вычитать из значения по индексу R значение по выбранному индексу L: S = P[R] - P[L-1];
- Для быстрого подсчёта посчитаем для каждого индекса во втором вспомогательном массиве L индекс исторического минимума для каждого R_i, т.е. текущего индекса в M или M[i];

**Пример:**
| index | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | 
| A | 7 | -2 | 3 | -10 | -6 | 0 | -3 | 10 | 4 | 8 |  |
| P | 0 | 7 | 5 | 8 | -2 | -8 | -8 | -11 | -1 | 3 | 11 |
| L | 0 | 0 | 0 | 0 | 0 | 5 | 6 | 6 или 7 | 8 | 8 | 8 |

<br>

<ins>Реализуем решение задачи о сумме на подматрице в массиве массивов:</ins>
- Имеем исходную матрицу A размера n x m;
